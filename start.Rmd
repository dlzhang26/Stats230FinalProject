---
title: "STAT230 Project Starting Point"
author: 'Group D: Arthur, Donna, Kaitlyn, Michael'
date: "Date"
output:
  pdf_document:
    fig_height: 3
    fig_width: 5
  word_document: default
---

```{r include=FALSE}
library(mosaic)
require(tidyr)
require(lattice)
library(gridExtra)
library(grid)
options(scipen=5)
```

```{r include=FALSE}
# Some customization.  You can alter or delete as desired (if you know what you are doing).
# knitr settings to control how R chunks work.
require(knitr)
opts_chunk$set(
  tidy=FALSE,     # display code as typed
  size="small"    # slightly smaller font for code
)
trellis.par.set(theme=theme.mosaic())  
options(digits=5)
```




## Proposal    
**PURPOSE**

 
**DATA**

**POPULATION** 

 
**RESPONSE VARIABLE**

 
We chose Post Injury Play Time as our response variable. This is a quantitative variable, and is represented by the average number of downs per game after the player returns from the injury. The distribution is bi-modal; many observations are close to 0 downs - likely influenced by  players who did not return from their injury, and many appear at 99 downs. Currently, we are unable to provide descriptive statistics for Post Injury Play Time, because we have not been able to mutate our data to become purely numerical due to the presence of units in the observations. 
 
**EXPLANATORY VARIABLES**

 
**Pre-season injury** is a qualitative variable, categorized by Yes – the player sustained an injury before the season began, and No – the player did not sustain an injury before the season.

**Player position** is a qualitative variable, categorized by all the possible positions on a football team. 

 
**Season** is a qualitative variable, categorized in (start of season/end of season) format:  2012/2013, 2013/2014, and 2014/2015. 

**Number of games missed** is a quantitative variable, measured by how many games in one season a player missed after sustaining the injury. 

**Average play time** before the injury is a quantitative variable, measured in the average number of downs per game that occurred before the player sustained the injury. 

 
**Week of injury** is a quantitative variable, measured in the number of weeks into the football season that the player sustained the injury.


## Import Data & Wrangling   
   

```{r, warning = FALSE, echo = FALSE, include=FALSE}
#getwd() in console to find the directory where the csv file is stored on your computer
#For your computer you need to change the path so you can reed the file
#alldata <- read.csv("/home/class26/FIRSTPARTOFEMAIL/ConcussionInjuries2012-2014.csv") 

#For Donna's computer
alldata <- read.csv("C:/Users/donna/OneDrive/Documents/STAT230/Stats230FinalProject/ConcussionInjuries2012-2014.csv") 

#For Kaitlyn's computer
#alldata <- read.csv("/home/class27/khuang27/STAT230FinalProject/ConcussionInjuries2012-2014.csv")

##glimpse(alldata)
##names(alldata)
```

```{r, warning = FALSE, echo = FALSE, include=FALSE}

studydata <- rename(alldata, OppTeam = Opposing.Team, PostInjuryPlayTime = Play.Time.After.Injury, PreseasonInjury = Pre.Season.Injury., OnWinningTeam = Winning.Team., amtTimeInjured = Weeks.Injured, TimeOfInjury = Week.of.Injury, UnknownInjury = Unknown.Injury., ReportedTypeOfInjury = Reported.Injury.Type, AveragePreInjuryPlayTime = Average.Playtime.Before.Injury, TotalSnaps = Total.Snaps, amtGamesMissed = Games.Missed)
#names(studydata)
```



## Exploratory Data Analysis (EDA)

```{r, warning = FALSE, echo = FALSE, fig.height = 3, fig.width = 15}
m1 <- gf_histogram(~TimeOfInjury, data = studydata)
m2 <- gf_histogram(~amtTimeInjured, data = studydata) ## binary data idk what the data means like 1 week or 0 weeks??
m3 <- gf_bar(~ PreseasonInjury, data = studydata, fill = c("darkred", "forestgreen"))

m4 <- gf_bar(~Season, data = studydata)

m5 <- gf_histogram(~amtGamesMissed, data = studydata)

grid.arrange(m1, m2, m3, m4, m5, ncol = 5,heights = .5) 



#barplot(table(studydata$AveragePreInjuryPlayTime), main="Pre Injury Playtime",ylab="Freqency", cex.axis = 0.8, cex.names = 0.6, las=2)

#barplot(table(studydata$PostInjuryPlayTime), main="Post Injury Playtime",ylab="Freqency", cex.axis = 0.8, cex.names = 0.6, las=2)



```
```{r, warning = FALSE, echo = FALSE}
barplot(table(studydata$Position), main="Positions",ylab="Freqency", cex.axis = 0.8, cex.names = 0.6, las=2)
```

